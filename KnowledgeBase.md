# Knowledge Base #

Table of contents:


## Hello World! ##

  1. Download the phpdesktop zip file and extract it
  1. Run the "phpdesktop-chrome.exe" executable
  1. What you see in application window is the output generated by PHP scripts in the www/ directory. PHP Desktop comes by default with some PHP scripts that test various features.
  1. When you're done playing with the default scripts clear the www/ directory and copy your own PHP scripts. If you're using a PHP framework then see the PhpFrameworksSupport wiki page that provides step by step instructions for configuring many popular frameworks.

## How does PHP Desktop work? ##

First, a [Mongoose](http://code.google.com/p/mongoose/) web server is started. It is pointed to listen at `http://127.0.0.1:54007/` (54007 is some random port assigned). Its document root is set to the "www/" directory. Next, an embedded web browser control ([Internet Explorer](http://en.wikipedia.org/wiki/Trident_(layout_engine)) or [Chrome embedded](http://en.wikipedia.org/wiki/Chromium_Embedded_Framework)) is initialized in application's window and navigated to the location at which web server is listening. This browser does not have any Back/Forward buttons or other visible controls that would identify it as a web browser. It is not required for the Google Chrome browser to be installed on user's computer, as it is embedded in phpdesktop binaries with no external dependencies.

## Which browser engine to choose? ##

Internet Explorer (abbreviated MSIE) gives you smaller binaries, but you do not know the version of Internet Explorer that will be installed on user's computer. Incompatibilities between different IE version can be troublesome. A good HTML5 support is only available since IE 9. Also it is not guaranteed that the version of Internet Explorer control embedded in application will be the same as the version of Internet Explorer installed on a computer. For example on Windows 7 SP1 with Internet Explorer 8 installed navigator.userAgent shows "MSIE 7.0".

Chrome binaries take more space, but what you get is a great HTML5 support. You also get certainty that your application will always look and work the same on all computers, no matter what operating system or service packs are installed on user machine. This is because the Chrome browser is embedded inside phpdesktop binaries.

## Should I use PHP 5.4 or newer? ##

PHP 5.4 series is the last versions to support Windows XP/2003. Spawning of the PHP CGI process will fail in PHP 5.5 series on Windows XP. If you want to support XP use the PHP 5.4 series. Read the [PHP 5.5 migration docs](http://www.php.net/manual/en/migration55.incompatible.php) on the php.net website.

Windows XP still has 23.87% usage share (as of September 2014) on Desktop. That's quite a large user base. So most probably you want to use PHP 5.4, so that you can support this OS. For the most recent OS usage share statistics see the [Usage share of operatings systems](https://en.wikipedia.org/wiki/Usage_share_of_operating_systems) on the wikipedia.org website.

## PHP interpreter & extensions ##

If you would like to update the php version, just overwrite files in the "php/" directory. Download the latest PHP release from http://windows.php.net/download/ (x86, NTS - non thread safe). Extract the zip, copy the dlls/exe to the php/ directory and you're ready to go.

The minified binary contains only minimum set of files required. There is no unicode support as "icudt" dlls were removed. Minified binaries come with the following extensions: `curl`, `gd2`, `mysql`, `mysqli`, `pdo_pgsql`, `pdo_sqlite`, `pgsql`, `sqlite3`.


## How do I protect PHP sources in "www" directory? ##

You can load custom php extensions, thus you can use many of the available php encoders such as:
  * Open source
    * [BLENC encoder](https://code.google.com/p/phpdesktop/wiki/SourceCodeProtection#BLENC_encoder) - a PECL extension. Supports latest PHP versions.
    * [bcompiler](https://code.google.com/p/phpdesktop/wiki/SourceCodeProtection#bcompiler) - a PECL extension. Provides good protection by compiling PHP to bytecode. Unfortunately supports only PHP 5.3 or lower.
  * Free
    * [PHTML Encoder](http://www.rssoftlab.com/phpenc.php) - standard version is free. Supports PHP 5.4 and 5.3. Extension is available only for Thread Safe version of PHP. PHP Desktop bundles Non Thread Safe version of PHP by default, so it is required to update PHP binaries.
    * [PHP Protect](http://www.phpprotect.info/) - only obfuscates source code
  * Commercial
    * [Ion Cube](http://www.ioncube.com/sa_encoder.php)
    * [Zend Guard](http://www.zend.com/en/products/guard/)
    * [Source Guardian](http://www.sourceguardian.com/)
    * [Nu-Coder](http://www.nusphere.com/products/nucoder.htm)
    * [CodeLock](http://www.codelock.co.nz/) - a cheap one

## Settings ##

See these wiki pages: [Settings](Settings.md), [ChromeSettings](ChromeSettings.md), [MSIEsettings](MSIEsettings.md).


## Application name ##

Rename the "phpdesktop-chrome.exe" executable to whatever name your application should have.


## Application details ##

Apart from changing the name of the executable file, you may also want to change application details embedded in the executable. See what these are by clicking on file properties and selecting the "Details" tab. Some of these details may be displayed to user when running application (by OS alert or firewall), so it's best to customize it to avoid user confusion (user being informed by OS that he is running "PHP Desktop", when in fact he downloaded application named "XXX").

Here are the steps to modify application details:

  1. Download [Resource Hacker](http://www.angusj.com/resourcehacker/) and run it.
  1. From the "File" menu select "Open" and navigate through drive to find "phpdesktop-chrome.exe" (or whatever the name of your executable is).
  1. On the left side a tree control will appear. Expand "/Version Info/1/1033" and change the strings: "FileDescription", "FileVersion" and others.
  1. Save it.


## Application installer ##

PHP Desktop doesn't provide a single executable file, but that shouldn't be a concern. Most of the software is distributed in a form of an installer and we recommend to go this way. Try one of these to create an installer for your application:

  * [Inno Setup](http://www.jrsoftware.org/isinfo.php) + [Inno Script Studio](https://www.kymoto.org/products/inno-script-studio/overview) (see also [ISTool](http://sourceforge.net/projects/istool/)).
  * [NSIS installer](http://nsis.sourceforge.net/Main_Page) + [HM NSIS Edit](http://hmne.sourceforge.net/).

If you also need an Auto Updater see this post: https://groups.google.com/d/msg/phpdesktop/CfZqiI3eMPY/2LNHbhkxumgJ


## How to use SQLite? ##

See the [UsingSQLite](UsingSQLite.md) wiki page.


## Can I use MySQL? ##

MySQL is not easily portable. It requires a system service to run in the background. It needs to be installed on user's machine. You could embed a mysql installer in your application installer, but there are some legal issues in doing so. Mysql is licensed under the GPL license, so you can only embed it in open source projects. If you have a commercial closed source project and would like to distribute mysql along with your app installer, then you would have to buy a commercial license for mysql. There is no clear price presented on the mysql website. When you try to google "mysql commercial license cost" it doesn't look too pretty. The costs seem to be per installed server or they want a percentage of the price of your product.

The beauty of [SQLite](http://www.sqlite.org/) is that it's portable, requires only a php extension to be loaded and it's totally free. It is a perfect fit for a desktop application.

If you need some advanced database solution similar to mysql, that is allowed to be distributed with commercial projects, then take a look at [PostgreSQL](http://www.postgresql.org/), its license is non-restrictive (BSD/MIT alike).

## Can I use PHP Desktop in a commercial closed sourced project? ##

Yes. PHP Desktop is released under the [BSD 3-clause license](http://opensource.org/licenses/BSD-3-Clause) that is almost non-restrictive. The only requirements are that the contents of the [license.txt](https://code.google.com/p/phpdesktop/source/browse/phpdesktop-chrome/license.txt) file is distributed along with your application in a plain readable form and that you mention in your product documentation that it uses the PHP Desktop framework.

Other third party libraries that PHP Desktop includes also use non-restrictive licenses that allow for commercial use:

  * [CEF](https://code.google.com/p/chromiumembedded/) and [Chromium](http://www.chromium.org/) also use BSD 3-clause license.
  * The Mongoose webserver is from revision [04fc209](https://github.com/cesanta/mongoose/tree/04fc209644b414d915c446bb1815b55e9fe63acc) that is [MIT licensed](http://opensource.org/licenses/MIT) (we don't use the latest Mongoose that went commercially and was GPL'ed).
  * [PHP](http://www.php.net/) uses the [PHP License](http://www.php.net/license/3_01.txt)
  * The [JSON parser library](https://github.com/udp/json-parser) uses the [BSD 2-clause license](http://opensource.org/licenses/BSD-2-Clause).


## Feature X works in Google Chrome, but doesn't work in PHP Desktop Chrome ##

In contrast to what name suggests, PHP Desktop Chrome really embeds Chromium browser (to be exact Chromium Embedded Framework which is based on Chromium browser), thus not all features of Google Chrome may be supported in PHP Desktop Chrome. Also note that currently PHP Desktop Chrome embeds Chrome 31 (branch 1650) and latest Google Chrome may be for example Chrome 38 (as of this writing).

To see if some feature/bug is working/fixed in newer CEF (Chromium Embedded Framework) release that PHP Desktop uses internally, please perform the following steps:
  * Go to http://www.cefbuilds.com/
  * Choose a branch
  * Download Windows 32-bit > `TestApp` binaries
  * Run cefclient.exe and navigate to phpdesktop web server url (in phpdesktop from mouse context menu click "Open page in external browser")


## Url rewriting support ##

Basic support for url rewrites is supported since PHP Desktop Chrome 31.8 / MSIE 1.14. This allows application to use pretty urls. See the ["web\_server"](https://code.google.com/p/phpdesktop/wiki/Settings#web_server) > "404\_handler" option on the [Settings](Settings.md) wiki page.


## Problem running Drupal app due to REQUEST\_URI env variable not containing QUERY\_STRING ##

This issue was fixed in PHP Desktop 31.8.



## Problem running PHP script ##

Go to php/ directory and run script from command line. This will let you see for example if any of the php extensions failed loading. It may possibly also reveal other issues.

```
cd phpdesktop/php/
php.exe ../www/script.php
php-cgi.exe ../www/script.php
```

php.exe and php-cgi.exe are not exactly the same. These are two different programs and have a bit different implementations. It's best to test script using both executables, to increase your chance of detecting the issue. PHP Desktop uses CGI interface to execute php script and php-cgi.exe is for that. The other one php.exe is an official way for executing php scripts from command line. A php-cgi.exe uses special interface and isn't really suitable to be executed from command line, however it happens to work so it does not harm to test it as well.

Setting `display_startup_errors=On` in php.ini will display php startup errors in a friendly manner using graphical message. This way you won't have to run script from command line to see the startup error, for example when loading php extension fails.

## Error 500: Internal Server Error. CGI program sent malformed or too big (>16384 bytes) HTTP headers ##

That error may occur when php startup fails. It may be a problem with php.ini configuration. Or may be that php script sent malformed or too big headers. Similar messages were reported in the past for Python binaries in Python Desktop, in that case a dll library was missing. You have to run script from command line to see the php startup error message. Alternatively you can set `display_startup_errors=On` option in php.ini and you should see a graphical message about the real error (eg. loading extension failed). Problem reported in [Issue 131](https://code.google.com/p/phpdesktop/issues/detail?id=131).

## Error 500: Internal Server Error. Cannot spawn CGI process [C:\Documents and Settings\...\www\index.php]: No such device or address ##

That error may occur when launching PHP CGI process fails. This will for example happen if you try to run phpdesktop with PHP 5.5/5.6 on Windows XP. If you would like to support Windows XP use PHP 5.4 instead, as this is the last series that supports this OS. Problem reported in [Issue 127](https://code.google.com/p/phpdesktop/issues/detail?id=127).

## Error when application is placed in a path that contains unicode characters ##

PHP doesn't support unicode paths, this may change in the next PHP 6 release, but until that it's a problem that can't be easily resolved. When PHP Desktop is launched from a location that contains unicode characters it will display an [error message about the unicode problem](https://code.google.com/p/phpdesktop/issues/detail?id=74#c2).

One solution to the unicode problem would be to create an [NTFS symbolink link](http://en.wikipedia.org/wiki/NTFS_symbolic_link) pointing to the application directory and launch application using that symbolic link. However this will work only on NTFS partitions, it won't work on FAT/FAT32 partitions (application installer may detect that and act appropriately). If you don't have mklink.exe on your system you can [download it from here](http://technet.microsoft.com/en-us/library/cc753194(WS.10).aspx). Example usage:

```
mklink /D C:\sites C:\gonzález\sites
```

You can read more about unicode issues and solutions in the [Deployment issues](#Deployment_issues.md) section further down on this page.

## Black/White application screen ##

If you get a black or white screen in PHP Desktop Chrome then this may be caused by incompatible GPU (video card) drivers. There are following solutions to this:

1. When PHP Desktop is updated to a newer Chrome version then the problem may be fixed.

2. Try updating your video card drivers to the latest version available.

3. You can disable GPU rendering completely so that only CPU will be used. Note that this will degrade performance if you're using any advanced 3D features in browser. It will affect 2d accelerated content as well. Disable GPU rendering by adding the "disable-gpu" and "disable-gpu-compositing" command line switches in the settings.json file, like this:

```
"command_line_switches": {
  "disable-gpu": "",
  "disable-gpu-compositing": ""
},
```

## How can I access files outside "www" directory? ##

PHP Desktop does not put restrictions on what files a php script can access in OS. The default php.ini shipped does not have "open\_basedir" option set that would limit file access.

## mail() function doesn't work ##

PHP mail() function requires a local smtp server running on Windows. You can use PHPMailer library to send emails, it doesn't require a smtp server, see: https://github.com/PHPMailer/PHPMailer

## Flash works in Google Chrome, but not in PHP Desktop ##

Google Chrome bundles a proprietary version of Flash called Pepper Flash. PHP Desktop does not include Flash out of the box. You need to install Flash (NPAPI version) in your OS:

  1. Go to http://get.adobe.com/flashplayer/otherversions/
  1. Select an operating system
  1. Select NPAPI version of plugin (for Firefox)

## Can the www/ directory be encrypted and embedded in the exe file? ##

There are plans for encrypting and embedding static resource files (js/html/images) in the phpdesktop executable. See [Issue 18](https://code.google.com/p/phpdesktop/issues/detail?id=18) that is to implement this feature. Regarding PHP scripts, these can be protected using many of the available php encoders.


## How can I make phpdesktop binaries smaller? ##

See this post from the PHP Desktop Forum:<br>
<a href='https://groups.google.com/d/msg/phpdesktop/G3hb0TeoPGA/AmYGUEj6ldAJ'>https://groups.google.com/d/msg/phpdesktop/G3hb0TeoPGA/AmYGUEj6ldAJ</a>

With the steps from the post above you can make your application installer with PHP Desktop Chrome binaries to be only about 17 MB in size.<br>
<br>
<h2>How do I read/write to Windows Registry?</h2>

Use the php_com_dotnet.dll extension. It needs to be enabled in php.ini. To read from registry use this code:<br>
<br>
<pre><code>$shell = new COM("WScript.Shell") or die("Requires Windows Scripting Host");<br>
$some = $shell-&gt;RegRead("HKEY_LOCAL_MACHINE\\SOFTWARE\\...");<br>
</code></pre>

To write to a registry use the <a href='http://msdn.microsoft.com/en-us/library/yfdfhz1b(v=vs.84).aspx'>RegWrite</a> method.<br>
<br>
To import a .reg file issue a system command to execute the reg tool:<br>
<br>
<pre><code>system("reg import file.reg");<br>
</code></pre>

Type "reg /?" from the command line to know more options for the reg tool.<br>
<br>
<h2>How to call functions from a DLL file?</h2>

See this post:<br>
<a href='https://groups.google.com/d/msg/phpdesktop/m2E3i7xD6i0/MvT7RjAUERcJ'>https://groups.google.com/d/msg/phpdesktop/m2E3i7xD6i0/MvT7RjAUERcJ</a>

<h2>How to get a unique computer identifier?</h2>

A unique computer identifier is useful when implementing License Keys for your application to prevent unauthorized use.<br>
<br>
You can get a Mac Address of a network adapter by parsing output of the "ipconfig /all" command with the system() function. Though there are many network adapters, some of them virtual and can be easily spoofed.<br>
<br>
You can query registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography</code> for <code>MachineGuid</code> which is generated during OS installation. But this can be easily spoofed using regedit.<br>
<br>
You can query OS for some software/hardware information. For example to get Windows product unique identifier run the command:<br>
<br>
<pre><code>C:\Windows\System32\wbem\wmic.exe path win32_computersystemproduct get uuid<br>
UUID<br>
E8F59000-0275-0000-0000-000000000000<br>
</code></pre>

Some notes:<br>
<ul><li>On some systems the wbem/ directory may not be in PATH, so to be sure we're providing the full path to the wmic executable.<br>
</li><li>The "C:\Windows" path shouldn't be hardcoded, instead you should use <code>$_ENV["SYSTEMROOT"]</code>.<br>
</li><li>The MSDN page states that if uuid is not available, a <a href='http://msdn.microsoft.com/en-us/library/aa394105(v=vs.85).aspx'>UUID of all zeros is used</a>.<br>
</li><li>One of users has reported that UUID may not be unique on two different machines. See this post: <a href='https://groups.google.com/d/msg/phpdesktop/YbuXL_FVZRQ/0YSc0uZwAjsJ'>https://groups.google.com/d/msg/phpdesktop/YbuXL_FVZRQ/0YSc0uZwAjsJ</a> . It's best to query multiple software/hardware information and create unique hash based on these values.</li></ul>

To query processor identifier (in this case there isn't available a unique identifier, only identifier of the processor model which may not be unique):<br>
<br>
<pre><code>C:\Windows\System32\wbem\wmic.exe path win32_processor get uniqueid<br>
UniqueId<br>
<br>
C:\Windows\System32\wbem\wmic.exe path win32_computersystemproduct get uuid path win32_processor get processorid<br>
ProcessorId<br>
BFEBFBFF000306A9<br>
</code></pre>

You can query many other hardware information:<br>
<br>
<pre><code>win32_computersystemproduct: name, uuid, vendor, version<br>
win32_processor: uniqueid, processorid, name, manufacturer, maxclockspeed <br>
win32_bios: manufacturer, smbiosbiosversion, identificationcode, serialnumber, releasedate, version<br>
win32_diskdrive: model, manufacturer, signature, totalheads<br>
win32_baseboard: model, manufacturer, name, serialnumber<br>
win32_videocontroller: driverversion, name<br>
</code></pre>

You have to decide which ones will decide about uniqueness of a computer. You  may want to query several of them and not depend only on one, as sometimes it may not be available, or be of zeroes like uuid. After you obtain a few of such strings you can calculate a md5 hash to have a short unique identifier.<br>
<br>
See this MSDN page for more win32 classes that you can query:<br>
<a href='http://msdn.microsoft.com/en-us/library/aa394084(v=vs.85).aspx'>http://msdn.microsoft.com/en-us/library/aa394084(v=vs.85).aspx</a>

PHP example code for fetching output of a command:<br>
<pre><code>$output = shell_exec("echo | {$_ENV['SYSTEMROOT']}\System32\wbem\wmic.exe path win32_computersystemproduct get uuid");<br>
if ($output) echo "Command succeeded. Output=".$output;<br>
else echo "Command failed.";<br>
</code></pre>

The "echo | command.." syntax is to avoid hang that happens for some programs on Windows XP, see <a href='https://code.google.com/p/phpdesktop/issues/detail?id=124'>Issue 124</a> for more details.<br>
<br>
<h2>How to capture Audio and Video in HTML5?</h2>

To be able to use getUserMedia() function you need to set the "enable-media-stream" switch in the settings.json file.<br>
<br>
See also this post on the forum:<br>
<a href='https://groups.google.com/d/msg/phpdesktop/RJEnq_CfLIg/YdrXitCRndUJ'>https://groups.google.com/d/msg/phpdesktop/RJEnq_CfLIg/YdrXitCRndUJ</a>


<h2>HTML5 Persistent Storage doesn't work (local storage, indexed DB, web sql)</h2>

The storage doesn't persist between application restarts. The issue is that the storage is binded to both domain and port. PHP Desktop by default listens on a random port assigned by OS, to avoid port conflicts. The solution for the storage to persist is to set a fixed port (eg. 54007) in the settings.json file:<br>
<br>
<pre><code>"web_server": {<br>
    "listen_on": ["127.0.0.1", 54007],<br>
</code></pre>

See <a href='https://code.google.com/p/phpdesktop/issues/detail?id=108'>Issue 108</a> that is to alter Chromium behavior to allow for random port, while still being able to use persistent storage.<br>
<br>
Currently requests for more persistent storage space don't work, see <a href='https://code.google.com/p/phpdesktop/issues/detail?id=107'>Issue 107</a>.<br>
<br>
<h2>Audio and video support in PHP Desktop Chrome</h2>

First, some things to clarify. What PHP Desktop really embeds is a Chromium browser that Google Chrome is based on. Though, Chromium is open source, Google Chrome is not. There are proprietary audio/video codecs that are not free like MP3 / AAC / MP4 / H.264. Google Chrome is a commercial project and they bought licenses so that they can distribute proprietary video/audio codecs.<br>
<br>
Open the html5test.com website in the PHP Desktop browser and see the results for audio/video support (as of PHP Desktop Chrome 31.3):<br>
<br>
<b>Audio support</b>

<pre><code>audio element       Yes ✔<br>
Web Audio API       Prefixed ✔<br>
Speech Recognition  Prefixed ✔<br>
Speech Synthesis    No  ✘<br>
PCM audio support   Yes ✔<br>
AAC support         No  ✘<br>
MP3 support         No  ✘<br>
Ogg Vorbis support  Yes ✔<br>
Ogg Opus support    No  ✘<br>
WebM support        Yes ✔<br>
</code></pre>

<b>Video support</b>

<pre><code>video element            Yes ✔<br>
DRM support              Prefixed ✔<br>
Media Source extensions  Yes ✔<br>
Subtitle support         Yes ✔<br>
Poster image support     Yes ✔<br>
Codec detection          Yes ✔<br>
MPEG-4 support           No  ✘<br>
H.264 support            No  ✘<br>
Ogg Theora support       Yes ✔<br>
WebM with VP8 support    Yes ✔<br>
WebM with VP9 support    Yes ✔<br>
</code></pre>

<h2>How to prevent users from browsing app outside the phpdesktop executable?</h2>

You can check for user agent string which will be usually very specific. For example in PHP Desktop Chrome it is "<code>Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36</code>". You should be safe to check against it, as users will usually have the latest Google Chrome installed on their system.<br>
<br>
You may also overwrite that user agent string with your own by setting the "user-agent" switch through the command_line_switches option, see the ChromeSettings wiki page.<br>
<br>
You may also check through javascript for the "phpdesktop" object. This object will be available only in phpdesktop embedded browser, see the JavascriptApi wiki page.<br>
<br>
<br>
<h2>What are the disadvantages of using PHP Desktop over Java or C++?</h2>

See this post on the forum:<br>
<a href='https://groups.google.com/d/msg/phpdesktop/xN-fNB0C4Yg/LZ80-fP0tYIJ'>https://groups.google.com/d/msg/phpdesktop/xN-fNB0C4Yg/LZ80-fP0tYIJ</a>


<h2>Deployment issues</h2>

Due to <a href='https://en.wikipedia.org/wiki/User_Account_Control'>UAC</a> security features on Windows Vista/7/8 you don't have permission to modify files in the "Program Files" or "Program Files (x86)" directories, it requires administrative privileges. So if you install the application to the Program Files directory, your scripts residing in the www/ directory, won't be able to write files inside that directory. You are supposed to save your data (database, file uploads) in the <code>"c:\Users\%user%\AppData\Local\appname"</code> directory.<br>
<br>
If you have scripts that already write in the www/ directory and do not want to modify them, then you should configure the application installer to install the whole www/ directory to the <code>"c:\Users\%user%\AppData\Local\appname"</code> directory and the rest of the files (dlls, pak, exe, php/ dir, locales/ dir) to the Program Files directory. If you do so, your installer needs to modify the "settings.json" file that is residing next to the phpdesktop executable, and change the "www_directory" setting (in "web_server" section) to point to the <code>"c:\Users\%user%\AppData\Local\appname\www"</code> directory. The "log_file" option should also be in a writable path.<br>
<br>
Another solution that is most straightforward, is to just install the whole application to the <code>"c:\Users\%user%\AppData\Local\appname"</code> directory.<br>
<br>
But there is a problem with the solutions above. PHP does not support unicode paths on Windows. The path to the php/ directory and path to the www/ directory cannot contain unicode characters. But user's name may contain unicode characters. Thus your app would be in <code>"C:\Users\Ąąśóć\AppData\Local\"</code> directory and this would cause php interpreter errors due to unicode characters in the path.<br>
<br>
The unicode path issues are not a concern when using the sqlite file database. See the explanation further down.<br>
<br>
There is the "C:\Users\Public" directory that is writable for any program. You could install app to that directory. But this is still not perfect, as you're providing a single instance of application for all users.<br>
<br>
You may install the whole app to the Program Files directory and still have permission to write in that directory by embedding a manifest in the phpdesktop executable that requires administrative privileges to run. This way all your files including the www/ directory may reside in the Program Files directory, and there won't be problems modifying files in that directory. One drawback is that your users may hesitate giving your application administrative privileges. This solution is not good from a security standpoint. See an example manifest that you would have to embed: <a href='https://code.google.com/p/phpdesktop/source/browse/phpdesktop-chrome/RequireAdministrator.manifest'>RequireAdministrator.manifest</a>.<br>
<br>
To sum up, you can try the following approaches to the write permission and unicode paths problems:<br>
<ol><li>Install the whole app to the "C:\Users\Public\appname" directory. This allows only for a single app installation for all users. Your application installer should handle Windows XP case, as C:\Users\Public doesn't exist on that OS.<br>
</li><li>You could add condition in your app installer, so that it detects if user's name contains unicode characters. If it contains then install app to the "C:\Users\Public\appname" or "Program Files" directory. This allows only for one app installation for all users. If user's name does not contain unicode characters then install application to the <code>"C:\Users\%user%\AppData\Local\appname"</code> directory.<br>
</li><li>Install the whole app to the "Program Files" directory. This allows only for a single app installation. You also must embed the RequireAdministrator.manifest in the phpdesktop executable so that app has write permission in the directory it has been installed to.<br>
</li><li>You could ignore the whole unicode paths problem if your users language is English. It might work for you in 99% cases.</li></ol>

It seems that the sqlite database handles the utf-8 paths just fine (tested with pdo sqlite). This extension seems to work independently, thus the php unicode path problems are not an issue when using sqlite. If your application only needs to keep the sqlite database in user profile directory then you should be fine.<br>
<br>
There are some ways to access the unicode paths using external libraries/extensions:<br>
<ul><li>See the <a href='https://code.google.com/p/php-wfio/source/browse/trunk'>php-wfio</a> extension for PHP 5.4 only. Using a special scheme "wfio://" you can access unicode paths. See the examples in the tests directory. The extension needs to be build from sources.<br>
</li><li>See the <a href='https://github.com/nicolas-grekas/Patchwork-UTF8/blob/lab-windows-fs/class/Patchwork/Utf8/WinFsStreamWrapper.php'>WinFsStreamWrapper.php</a> class. It requires the "php_com_dotnet.dll" extension and uses the COM object to instantiate Windows Scripting object. It suffers from Windows sometimes returning non-ASCII chars in shortPath on non-latin computers. No workaround found currently. Thus the php-wfio extension is a more reliable solution.</li></ul>

PHP 6 is planned to support unicode filenames on Windows. A quote by Pierre Joye from 2013-01-07:<br>
<br>
<blockquote>A better solution I work on for previous php version (incl. 5.5 as I<br>
won't make it in time) is an extension which would override existing<br>
functions. Next major version (6) will support unicode filenames,<br>
which will solve the 255 chars horrible limitation.</blockquote>

Reference:<br>
<a href='http://marc.info/?l=php-internals&m=135758611811889&w=2'>http://marc.info/?l=php-internals&amp;m=135758611811889&amp;w=2</a>

<h2>Problems with cache</h2>

By default the MSIE control embedded caches the pages and the css/js files. There is no option to disable that cache, you have to handle this yourself by sending appropriate no-cache headers for the php pages and by adding some random variables to the path of the css/js files to prevent the caching:<br>
<br>
<pre><code>&lt;link href="style.css?r=&lt;?php echo time(); ?&gt;" rel="stylesheet" type="text/css"&gt;<br>
</code></pre>

<h2>What are other projects similar to PHP Desktop?</h2>

<a href='http://www.exeoutput.com/'>ExeOutput</a> (commercial) - supports IE and Chrome. This project wasn't updated since a year and the latest version available embeds and old version of Chrome (21.x). It embeds PHP using PHP API. PHP scripts are embedded in exe and may optionally be encoded using bcompiler (up to PHP 5.3 only). It does not serve webpages through CGI/webserver like PHP Desktop does, so memory leaks may be an issue. Embedding PHP interpreter through PHP API has disadvantages, some features work differently. There may be issues with uploads, output buffering, includes, paths and others. There are issues with running more than one php script simultaneously. Some php extensions may not work.<br>
<br>
<a href='https://github.com/TideSDK/TideSDK/wiki/Using-TideSDK-with-PHP'>TideSDK</a> (beta) - embeds the Webkit engine. No webserver is running, embedding is done using PHP API. PHP is embedded on a webpage similarly to a javascript language, so it can interact with DOM. The downside of that is that it requires you to program in a certain way. Most probably you won't be able to reuse existing scripts. Frameworks like Laravel or Zend Framework won't work. This project was abandoned, the authors are working on a successor called "TideKit".<br>
<br>
<a href='http://www.zzee.com/phpexe/'>ZZEE PHPExe</a> and <a href='http://www.zzee.com/php-gui/'>ZZEE PHP GUI</a> - both embed Internet Explorer engine.<br>
<br>
<a href='http://developer.appcelerator.com/doc/desktop/php'>Titanium Desktop for PHP</a> - embeds the Webkit engine. This project is similar to TideSDK, though it it is not developed anymore since about 2-3 years.<br>
<br>
<a href='http://wapache.sourceforge.net/'>Wapache</a> - embeds Apache 2 webserver and uses Internet Explorer engine.<br>
<br>
<a href='http://www.nusphere.com/products/phpdock.htm'>PhpDock</a> - not developed anymore, last release was 3 years ago. Uses Internet Explorer engine.<br>
<br>
<a href='https://github.com/naetech/nightrain'>Nightrain</a> - supported on many platforms (Win, Mac, Linux), but doesn't seem to provide a stable infrastructure. It embeds a different browser on different platforms (IE on Win, Webkit on Mac/Linux). Uses a php built-in single threaded web server that is not intended for production. There are many other issues like for example you can't hide debug console when running app on Windows.<br>
<br>
See a list of PHP to EXE compilers/converters in this stackoverflow question: <a href='http://stackoverflow.com/a/9046775/623622'>"Convert a PHP script into a stand-alone windows executable"</a>.<br>
<br>
<a href='https://github.com/rogerwang/node-webkit'>Node-webkit</a> - does not support PHP, but still worth mentioning. You can write native apps in HTML and Javascript with node-webkit. It also lets you call Node.js modules directly from the DOM.<br>
<br>
<a href='https://github.com/baconface/php-webkit'>PHP-Webkit</a> - The goal of php-webkit is to be able to package a PHP app within a NW.js project without needing the user to install and set up PHP on their system or connect to a remote PHP codebase.<br>
<br>
<a href='https://en.wikipedia.org/wiki/PHP-GTK'>PHP-GTK</a> - a set of language bindings for PHP which allow GTK+ GUI applications to be written in PHP. PHP-GTK provides an object-oriented interface to GTK+ classes and functions.<br>
<br>
<a href='https://en.wikipedia.org/wiki/WxPHP'>wxPHP</a> - a PHP extension that wraps the wxWidgets library, which allows to write multi-platform desktop applications that make use of the native graphical components available to the different platforms.<br>
<br>
<a href='http://winbinder.org/'>WinBinder</a> - low-level Windows API bindings for PHP.<br>
<br>
<a href='https://en.wikipedia.org/wiki/PHP-Qt'>PHP-Qt</a> - an extension for PHP5 that aims to write software with the Qt toolkit (a cross-platform application framework).